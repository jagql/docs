<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Resources | jagql</title>
    <meta name="description" content="A resource driven NodeJS framework to set up a {json:api} + GraphQL endpoint in record time.">
    
    
    <link rel="preload" href="/assets/css/0.styles.cb5f6a57.css" as="style"><link rel="preload" href="/assets/js/app.1082b650.js" as="script"><link rel="preload" href="/assets/js/17.5dfc139c.js" as="script"><link rel="prefetch" href="/assets/js/7.104f0666.js"><link rel="prefetch" href="/assets/js/2.9559f1fe.js"><link rel="prefetch" href="/assets/js/3.cc8a5dcd.js"><link rel="prefetch" href="/assets/js/4.6c0327fe.js"><link rel="prefetch" href="/assets/js/5.b7f61dc5.js"><link rel="prefetch" href="/assets/js/6.828d006e.js"><link rel="prefetch" href="/assets/js/8.1ca11d57.js"><link rel="prefetch" href="/assets/js/9.86a50049.js"><link rel="prefetch" href="/assets/js/10.57015bda.js"><link rel="prefetch" href="/assets/js/11.f77b854d.js"><link rel="prefetch" href="/assets/js/12.7480b5ec.js"><link rel="prefetch" href="/assets/js/13.b5dc4d39.js"><link rel="prefetch" href="/assets/js/14.1fa6b113.js"><link rel="prefetch" href="/assets/js/15.8ec93694.js"><link rel="prefetch" href="/assets/js/16.a88f0362.js"><link rel="prefetch" href="/assets/js/18.a32709ca.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cb5f6a57.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      jagql
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/pages/" class="nav-link router-link-active">Guide</a></div><a href="https://github.com/jagql/framework" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/pages/" class="nav-link router-link-active">Guide</a></div><a href="https://github.com/jagql/framework" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><a href="/pages/" class="sidebar-link">Introduction</a></li><li><a href="/pages/getting-started.html" class="sidebar-link">Getting Started</a></li><li><a href="/pages/configuration.html" class="sidebar-link">Configuration</a></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Project Setup</span><!----></p><ul class="sidebar-group-items"><li><a href="/pages/project_setup/resources.html" class="active sidebar-link">Resources</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/project_setup/relationships.html" class="sidebar-link">Relationships</a></li><li><a href="/pages/project_setup/handlers.html" class="sidebar-link">Handlers</a></li><li><a href="/pages/project_setup/chain_handlers.html" class="sidebar-link">Chain Handlers</a></li><li><a href="/pages/project_setup/query_filter.html" class="sidebar-link">Query and Filter</a></li><li><a href="/pages/project_setup/suggested_structure.html" class="sidebar-link">Suggested Structure</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>API Generation</span><!----></p><ul class="sidebar-group-items"><li><a href="/pages/apidocs/swagger.html" class="sidebar-link">Swagger</a></li><li><a href="/pages/apidocs/graphql.html" class="sidebar-link">GraphQL</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Debugging</span><!----></p><ul class="sidebar-group-items"><li><a href="/pages/debugging/metrics.html" class="sidebar-link">Metrics</a></li><li><a href="/pages/debugging/logging.html" class="sidebar-link">Application Logs</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Further Reading</span><!----></p><ul class="sidebar-group-items"><li><a href="/pages/further_reading/migrate_from_express.html" class="sidebar-link">Migrate from Express</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="resources"><a href="#resources" aria-hidden="true" class="header-anchor">#</a> Resources</h1><h3 id="defining-a-jagql-resource"><a href="#defining-a-jagql-resource" aria-hidden="true" class="header-anchor">#</a> Defining a <code>jagql</code> resource</h3><div class="language-javascript extra-class"><pre class="language-javascript"><code>jagql<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  resource<span class="token punctuation">:</span> <span class="token string">&quot;resourceNameGoesHere&quot;</span><span class="token punctuation">,</span>
  handlers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">/* see &quot;Handlers&quot; section */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  searchParams<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">/* see &quot;SearchParams&quot; section */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  attributes<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">/* see &quot;attributes&quot; section */</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="handlers"><a href="#handlers" aria-hidden="true" class="header-anchor">#</a> Handlers</h4><p>@jagql/framework ships with an example barebones implementation of an in-memory handler. It can be found at <code>jagql.MemoryHandler</code>. You can use it as a reference for writing new handlers.</p><p>Documentation for creating your own handlers can be found <a href="/pages/project_setup/handlers.html">here</a>.</p><p><code>MemoryHandler</code> works by allowing each defined resource to contain an <code>examples</code> property, which must be an array of JSON objects representing raw resources. Those examples are loaded into memory when the server loads and are served up as if they were real resources. You can search through them, modify them, create new ones, delete them, straight away.</p><p>Its a beautiful way of prototyping an experimental new API! Simply define the attributes of a resource, attach the <code>MemoryHandler</code> and define some <code>examples</code>:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>jagql<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  resource<span class="token punctuation">:</span> <span class="token string">&quot;photos&quot;</span><span class="token punctuation">,</span>
  handlers<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">jagql<span class="token punctuation">.</span>MemoryHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  attributes<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    url<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    photographer<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">one</span><span class="token punctuation">(</span><span class="token string">&quot;people&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;The person who took the photo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    articles<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">belongsToMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      resource<span class="token punctuation">:</span> <span class="token string">&quot;articles&quot;</span><span class="token punctuation">,</span>
      <span class="token keyword">as</span><span class="token punctuation">:</span> <span class="token string">&quot;photos&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  examples<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token string">&quot;aab14844-97e7-401c-98c8-0bd5ec922d93&quot;</span><span class="token punctuation">,</span>
      type<span class="token punctuation">:</span> <span class="token string">&quot;photos&quot;</span><span class="token punctuation">,</span>
      title<span class="token punctuation">:</span> <span class="token string">&quot;Matrix Code&quot;</span><span class="token punctuation">,</span>
      url<span class="token punctuation">:</span> <span class="token string">&quot;http://www.example.com/foobar&quot;</span><span class="token punctuation">,</span>
      photographer<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">&quot;people&quot;</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token string">&quot;ad3aa89e-9c5b-4ac9-a652-6670f9f27587&quot;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="searchparams"><a href="#searchparams" aria-hidden="true" class="header-anchor">#</a> SearchParams</h3><p><code>searchParams</code> controls which parameters will be accepted when searching for resources via a <code>GET</code> request to the <code>/:resource/?</code> route.</p><p>A resource's <code>searchParams</code> should be declared using the version of <code>Joi</code> bundled with <code>@jagql/framework</code>:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>searchParams<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  query<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In addition to the fields declared in the <code>searchParams</code> object, @jagql/framework will also accept the <code>sort</code>, <code>include</code>, <code>fields</code>, <code>filter</code> and <code>relationships</code> parameters.</p><h3 id="attributes"><a href="#attributes" aria-hidden="true" class="header-anchor">#</a> Attributes</h3><p><code>attributes</code> defines the properties declared on the given resource. A resource's <code>attributes</code> should be declared using the version of <code>Joi</code> bundled with <code>@jagql/framework</code>:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>attributes<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  url<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  height<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In addition to the functionality provided by <code>Joi</code>, there are 4x additional types:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>photos<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">one</span><span class="token punctuation">(</span><span class="token string">&quot;photos&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;This attribute is a relation to a photos resource&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

article<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">belongsToOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  resource<span class="token punctuation">:</span> <span class="token string">&quot;articles&quot;</span><span class="token punctuation">,</span>
  <span class="token keyword">as</span><span class="token punctuation">:</span> <span class="token string">&quot;comments&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;This attribute declares that the articles resource contains comments that links back to this resource&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

photos<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">many</span><span class="token punctuation">(</span><span class="token string">&quot;photos&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;This attribute is a relation to many photos resources&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

article<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">belongsToMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  resource<span class="token punctuation">:</span> <span class="token string">&quot;articles&quot;</span><span class="token punctuation">,</span>
  <span class="token keyword">as</span><span class="token punctuation">:</span> <span class="token string">&quot;comments&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;This attribute declares that the articles resource contains comments that links back to many of this resource&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Attributes can be marked as <code>required</code> using the regular <code>Joi</code> functionality. Required fields are enforced in both directions - user created/updated resources must comply with the required attributes, as must all resources provided by the server.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>url<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Attributes can be declared <code>readonly</code> by attaching metadata. Any attempt to write to this attribute when creating a new resource via POST, or when amending a resource via PUT/PATCH/DELETE will result in a validation error.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>url<span class="token punctuation">:</span> jagql<span class="token punctuation">.</span>Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">meta</span><span class="token punctuation">(</span><span class="token string">&quot;readonly&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;This attribute cannot be created nor modified by a user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If you look through the example json:api resources in the <code>/example/resources</code> folder things should become clearer.</p><h4 id="generateid"><a href="#generateid" aria-hidden="true" class="header-anchor">#</a> generateId</h4><p>By default, the server autogenerates a UUID for resources which are created without specifying an ID. To disable this behavior (for example, if the database generates an ID by auto-incrementing), set <code>generateId</code> to <code>false</code>. If the resource's ID is not a UUID, it is also necessary to specify an <code>id</code> attribute with the correct type. See <code>/examples/resorces/autoincrement.js</code> for an example of such a resource.</p></div><div class="page-edit"><div class="edit-link"><a href="https://github.com/jagql/jagql.github.io/edit/master/pages/project_setup/resources.md" target="_blank" rel="noopener noreferrer">Improve this documentation</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/pages/configuration.html" class="prev">
          Configuration
        </a></span><span class="next"><a href="/pages/project_setup/relationships.html">
          Relationships
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/17.5dfc139c.js" defer></script><script src="/assets/js/app.1082b650.js" defer></script>
  </body>
</html>
