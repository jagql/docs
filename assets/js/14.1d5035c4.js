(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{168:function(a,t,n){"use strict";n.r(t);var e=n(0),s=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var a=this,t=a.$createElement,n=a._self._c||t;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"chain-handlers"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#chain-handlers","aria-hidden":"true"}},[a._v("#")]),a._v(" Chain Handlers")]),a._v(" "),n("h3",{attrs:{id:"chaining-handlers-together-with-the-chainhandler"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#chaining-handlers-together-with-the-chainhandler","aria-hidden":"true"}},[a._v("#")]),a._v(" Chaining handlers together with the ChainHandler")]),a._v(" "),n("p",[a._v("This project ships with a handler called the "),n("code",[a._v("ChainHandler")]),a._v(". It's purpose is to make it easier to wrap the functionality of one handler with additional functionality. For example using the relational data store may be ideal for storing resources, but what if we want to add an authentication layer on top of those resources? An authentication handler shouldn't know or care about the storage of the underlying resource, it should only deal with authentication - we need an abstraction layer to help us glue all of this together.")]),a._v(" "),n("p",[a._v("To get started with the ChainHandler, go ahead and instantiate one:")]),a._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[a._v("var")]),a._v(" jagql "),n("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{attrs:{class:"token function"}},[a._v("require")]),n("span",{attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{attrs:{class:"token string"}},[a._v('"@jagql/framework"')]),n("span",{attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),n("span",{attrs:{class:"token keyword"}},[a._v("var")]),a._v(" testChainHandler "),n("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),n("span",{attrs:{class:"token class-name"}},[a._v("jagql"),n("span",{attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ChainHandler")]),n("span",{attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),n("p",[a._v("From there it's a simple case of attaching new function handlers to "),n("code",[a._v("testChainHandler")]),a._v(", following the naming convention of "),n("code",[a._v('("before"|"after")+function')]),a._v(" - eg "),n("code",[a._v("beforeSearch")]),a._v(", "),n("code",[a._v("beforeCreate")]),a._v(", "),n("code",[a._v("afterDelete")]),a._v(".")]),a._v(" "),n("p",[a._v("These new functions need to match the signatures of the functions they're overriding and need to pass the data onwards via a callback. For example, here are two valid functions that don't add any functionality. Notice how the callback values match the function signatures:")]),a._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("testChainHandler.beforeSearch = function(request, callback) {\n  return callback(null, request);\n};\n\ntestChainHandler.afterSearch = function(request, results, pagination, callback) {\n  return callback(null, results, pagination);\n};\n")])])]),n("p",[n("em",[a._v("NOTE")]),a._v(" The only exception to the above is that all "),n("code",[a._v("after")]),a._v(" function signatures are also passed the original "),n("code",[a._v("request")]),a._v(" object in addition to the other objects. This enables us to implement clever features on a per-request basis by providing a mechanism to push state between "),n("code",[a._v("before")]),a._v(" and "),n("code",[a._v("after")]),a._v(" functions.")]),a._v(" "),n("p",[a._v("With a new ChainHandler ready to go, this is how we can stack them up:")]),a._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[a._v("jagql"),n("span",{attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{attrs:{class:"token function"}},[a._v("define")]),n("span",{attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  resource"),n("span",{attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),n("span",{attrs:{class:"token string"}},[a._v('"articles"')]),n("span",{attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  handlers"),n("span",{attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" chainHandler1"),n("span",{attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{attrs:{class:"token function"}},[a._v("chain")]),n("span",{attrs:{class:"token punctuation"}},[a._v("(")]),a._v("chainHandler2"),n("span",{attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{attrs:{class:"token function"}},[a._v("chain")]),n("span",{attrs:{class:"token punctuation"}},[a._v("(")]),a._v("memoryHandler"),n("span",{attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n"),n("span",{attrs:{class:"token punctuation"}},[a._v("}")]),n("span",{attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),n("p",[a._v("The call stack when chaining multiple "),n("code",[a._v("ChainHandler")]),a._v("s together looks like this:")]),a._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("chainHandler1.beforeSearch\n  chainHandler2.beforeSearch\n    MemoryHandler.search\n  chainHandler2.afterSearch\nchainHandler1.afterSearch\n")])])])])}],!1,null,null,null);s.options.__file="chain_handlers.md";t.default=s.exports}}]);